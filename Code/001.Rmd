---
title: "<span style='font-size:125%;color:#CA1010'>Dades Educació</span style='color:#CA1010'>"
subtitle: "I'll be back"
author:
  - Marcos Montoro^[telecomontoro@uoc.edu] - Gaby Ramirez

date: "`r Sys.Date()`"
output: html_document
    
knit: (function(inputFile, encoding) { rmarkdown::render(inputFile, encoding = encoding, output_file = paste0("../Informe Comentaris/",format(Sys.Date(),"%Y-%m-%d"),"_Informe.html")) })




---


```{css sidenote, echo = FALSE}
.main-container {
  margin-left: 50px;       # 0px = max. to the left (with default padding)
  margin-right: 50px;       
}
}
#TOC {
  z-index: 2;
 }
 
 
 <style>
#my-table {
  position: fixed;
  top: 100px;
  left: 100px;
}
</style>
 
 
```



```{r echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = F,
                      warning = F)
#llibreries

if(require("pacman")=="FALSE"){
  install.packages('pacman')
  library('pacman')
  pacman::p_load(magrittr,readr,tokenizers,lubridate,tidyr,tidyverse,dplyr,corrpnlot,ggplot2,data.table,ggpubr,devtools,gplots) 
} else {
  library('pacman')
  pacman::p_load(magrittr,readr,lubridate,tokenizers,tidyr,tidyverse,dplyr,corrplot,ggplot2,data.table,ggpubr,devtools,gplots) 
}
p_loaded()  

options(scipen=999)

library(tidyverse) # Inclou dplyr, ggplot2 i altres llibreries
library(tidytext) # Llibreria per a l'anàlisi de text
library(stopwords) # Llibreria de stopwords
library(sentimentr)
library(readxl)
library(xlsx)
library(wordcloud)
library(dplyr)
library(DT)

```



```{r include=FALSE, warning=F, eval=T}
library(stringr)
library(Hmisc)
library(data.table)
library(lubridate)
library(gtools)
library(magrittr)
library(tidyr)
library(tidyverse)
library(compareGroups)
library(kableExtra)
library(plotly)
library(reshape2)



# Cargaoms crues
df <- read.csv2("../Data/Grid view.csv", sep = ",",
               encoding = "UTF-8")

df$Data.fi.prevista %<>% as.Date("%d/%m/%y")
df$Data.inici %<>% as.Date("%d/%m/%y")



```

# Anàlisi per Institut


```{r echo=FALSE}
# Suposant que 'Institut' és una variable categòrica
df %>% 
  group_by(Institut) %>% 
  summarise(Count = n()) %>% 
   arrange(desc(Count)) %>% 
  plot_ly(x = ~Institut, y = ~Count, type = 'bar', name = 'Institut') %>% 
  layout(title = 'Anàlisi per Institut')

```


# Anàlisi per Població


```{r}
df %>% 
  group_by(Població) %>% 
  summarise(Count = n()) %>% 
   arrange(desc(Count)) %>% 
  plot_ly(x = ~Població, y = ~Count, type = 'bar', name = 'Població') %>% 
  layout(title = 'Anàlisi per Població')
```





# Anàlisi per Especialitat

```{r}

# Suposant que 'Especialitat' és una variable categòrica
df %>% 
  group_by(Especialitat) %>% 
  summarise(Count = n()) %>% 
   arrange(desc(Count)) %>% 
  plot_ly(x = ~Especialitat, y = ~Count, type = 'bar', name = 'Especialitat') %>% 
  layout(title = 'Anàlisi per Especialitat')


```


# Anàlisi de Jornada

```{r}


# Suposant que 'Jornada' és una variable categòrica
df %>% 
  group_by(Jornada) %>% 
  summarise(Count = n()) %>% 
   arrange(desc(Count)) %>% 
  plot_ly(x = ~Jornada, y = ~Count, type = 'bar', name = 'Jornada') %>% 
  layout(title = 'Anàlisi de Jornada')
```




# Anàlisi de Dates

```{r}

# Convertint les columnes de dates a format de data
df$Data.inici <- as.Date(df$Data.inici)
df$Data.fi.prevista <- as.Date(df$Data.fi.prevista)

# Creant un gràfic de línia de temps
plot_ly(df, x = ~Data.inici, y = ~Data.fi.prevista, type = 'scatter', mode = 'lines') %>% 
  layout(title = 'Anàlisi de Dates')

```



# Plaçes sense cobrir especialitat

Per a realitzar l'anàlisi que desitges, primer necessitarem identificar quines places han quedat sense cobrir. Suposarem que una plaça està sense cobrir si el camp Substitut.a està buit. A continuació, calcularé el nombre total de places que han sortit i el nombre de places que han quedat sense cobrir per cada especialitat. El codi seria:



```{r}


df %>%
  group_by(Especialitat) %>%
  summarise(
    Places_Sortides = n(),
    Places_Sense_Cobrir = sum(Substitut.a == "", na.rm = TRUE)
  ) %>%
  arrange(desc(Places_Sortides)) %>%
  mutate(Especialitat = factor(Especialitat, levels = Especialitat)) %>%
  plot_ly(x = ~Especialitat, y = ~Places_Sortides, type = 'bar', name = 'Places Sortides') %>%
  add_trace(y = ~Places_Sense_Cobrir, name = 'Places Sense Cobrir', type = 'bar') %>%
  layout(title = 'Anàlisi de Places per Especialitat', barmode = 'group', xaxis = list(tickangle = -45))


```



```{r}
df_analisi <- df %>%
  group_by(Especialitat) %>%
  summarise(
    Places_Sortides = n(),
    Places_Sense_Cobrir = sum(Substitut.a == "", na.rm = TRUE)
  ) %>%
  arrange(desc(Places_Sortides))

datatable(df_analisi, 
          options = list(pageLength = 5, autoWidth = TRUE),
          caption = "Anàlisi de Places per Especialitat")

```






# Plaçes sense cobrir Institut

Per a realitzar l'anàlisi que desitges, primer necessitarem identificar quines places han quedat sense cobrir. Suposarem que una plaça està sense cobrir si el camp Substitut.a està buit. A continuació, calcularé el nombre total de places que han sortit i el nombre de places que han quedat sense cobrir per cada especialitat. El codi seria:



```{r}


df %>%
  group_by(Institut) %>%
  summarise(
    Places_Sortides = n(),
    Places_Sense_Cobrir = sum(Substitut.a == "", na.rm = TRUE)
  ) %>%
  arrange(desc(Places_Sortides)) %>%
  mutate(Especialitat = factor(Institut, levels = Institut)) %>%
  plot_ly(x = ~Institut, y = ~Places_Sortides, type = 'bar', name = 'Places Sortides') %>%
  add_trace(y = ~Places_Sense_Cobrir, name = 'Places Sense Cobrir', type = 'bar') %>%
  layout(title = 'Anàlisi de Places per Institut', barmode = 'group', xaxis = list(tickangle = -45))


```


```{r}
df_analisi <- df %>%
  group_by(Institut) %>%
  summarise(
    Places_Sortides = n(),
    Places_Sense_Cobrir = sum(Substitut.a == "", na.rm = TRUE)
  ) %>%
  arrange(desc(Places_Sortides))

datatable(df_analisi, 
          options = list(pageLength = 5, autoWidth = TRUE),
          caption = "Anàlisi de Places per Institut")

```

# Plaçes sense cobrir Població

Per a realitzar l'anàlisi que desitges, primer necessitarem identificar quines places han quedat sense cobrir. Suposarem que una plaça està sense cobrir si el camp Substitut.a està buit. A continuació, calcularé el nombre total de places que han sortit i el nombre de places que han quedat sense cobrir per cada especialitat. El codi seria:



```{r}


df %>%
  group_by(Població) %>%
  summarise(
    Places_Sortides = n(),
    Places_Sense_Cobrir = sum(Substitut.a == "", na.rm = TRUE)
  ) %>%
  arrange(desc(Places_Sortides)) %>%
  mutate(Especialitat = factor(Població, levels = Població)) %>%
  plot_ly(x = ~Població, y = ~Places_Sortides, type = 'bar', name = 'Places Sortides') %>%
  add_trace(y = ~Places_Sense_Cobrir, name = 'Places Sense Cobrir', type = 'bar') %>%
  layout(title = 'Anàlisi de Places per Població', barmode = 'group', xaxis = list(tickangle = -45))


```

```{r}
df_analisi <- df %>%
  group_by(Població) %>%
  summarise(
    Places_Sortides = n(),
    Places_Sense_Cobrir = sum(Substitut.a == "", na.rm = TRUE)
  ) %>%
  arrange(desc(Places_Sortides))

datatable(df_analisi, 
          options = list(pageLength = 5, autoWidth = TRUE),
          caption = "Anàlisi de Places per Institut")

```




#




```{r}

analisi_municipi <- df %>%
  group_by(Població) %>%
  summarise(
    Places_Sortides = n(),
    Places_Sense_Cobrir = sum(Substitut.a == "", na.rm = TRUE),
    Proporcio_Sense_Cobrir = Places_Sense_Cobrir / Places_Sortides
  ) %>%
  arrange(desc(Proporcio_Sense_Cobrir))

analisi_municipi

```



